## 1. 채팅 목록 조회 추가

> **URL:** `/conversations`
 >**Method:** `GET`
 >**Request**
>	**Query Params**
```json
{
	"page": number,
	"count_per_page": number
}
```
 >	**Response (200)**
```json
{
	"total_counts": number,
    "data": [{
        "id": "string(uuid)",
        "title": "string",
        "created_at": "Date"
    }]
}
```


---

## 2. 채팅방 진입(대화 내역 조회) 수정

> **URL:** `/conversations/{conversation_id}`
 >**Method:** `GET`
 >**Request**
>	**Path Params**
>		`conversation_id`
 >	**Response (200)**
```json
{
    "messages": [
    {
        "role": "assistant" | "user",
        "content": "string",
        "message_id": "string",
        // assistant role에만 들어감
        "has_reference"?: boolean, // 출처
        "has_search_result"?: boolean, // 위성영상 검색 결과
        "has_analysis"?: boolean, // 분석 결과
        "has_order"?: boolean // 주문 내역 조회
    }
    ]
}
```


---

## 3. 채팅방 제목 변경 수정

- **URL:** `/conversations/{conversation_id}`
    
- **Method:** `PATCH`
    
- **Request**
    
    - **Path Params**
        
        - `conversation_id`
            
    - **Request Body**
        
        ```json
        {
          "title": "string"
        }
        ```
        

---

## 4. 주문 내역 리스트 수정

- **URL:** `/orders`
    
- **Method:** `GET`
    
- **Request**
    
    - **Query Params**
        
        - `page`: number
            
        - `count_per_page`: number
            
        - `time_sequence`: ‘recent’ | ‘old’
            
        - `status`: ‘processing’ | ‘done’ | ‘fail’ (없으면 전체 다 보내주기)
            
- **Request Body**
    
    ```json
    {
      "total_counts": number,
      "data": [
        {
          "order_id": "string",
          "item_id": "string",
          "image_id": "string",
          "order_name": "string",
          "product_type": "visual" | "sr" | "toar" | "vv",
          "order_date": "Date",
          "credit_usage": number
        }
      ]
    }
    ```
    

---

## 5. 주문 내역 CSV 추출 수정

- **(swagger response class 정의)**
    

---

## 6. 채팅하기

- **URL:** `/conversation/{conversation_id}/chat/v1`
    
- **Method:** `POST`
    
- **Request**
    
    - **Path**
        
        - `conversation_id`
            
    - **Body**
        
        - `content`: string
            
        - `document_url`: string | null
            
        - `map_state`: { aoi: string | null; image_ids: string(uuid)[] | null; }
            
- **Response (stream)**
    
    - **Event**
        
        - `created`: 답변 시작을 의미합니다.
            
        - `in_progress`: 특정 task (agent or tool)이 진행되고 있음을 의미합니다.
            
        - `delta`: 텍스트 스트리밍 응답 또는 에러메시지 표출에 해당합니다.
            
        - `added`: 위성영상, 커맨드, 문서 출처, 웹 검색내용, 추천질문 등 멀티 에이전트가 텍스트 스트리밍 응답 이외에 내놓는 모든 item들이 추가됨을 의미합니다.
            
        - `done`: 답변이 모두 종료되었음을 의미합니다.
            
    - **Data**
        
        - 웹소켓 응답 데이터 스키마와 동일 (key: `role`, `content`, `message_id`, `conversation_id`(optional))
            

---

## 7. 채팅 - 문서(pdf) 업로드 url 요청

- **URL:** `/documents/url`
    
- **Method:** `POST`
    
- **Request**
    
    - **Request Body**
        
        - `file`: File
            
- **Response**
    
    ```json
    {
      "url": "string"
    }
    ```
    

---

## 8. 추천 질문 목록 조회

- **URL:** `/conversations/{conversation_id}/recommends`
    
- **Method:** `GET`
    
- **Request**
    
- **Response**
    
    ```json
    {
      "recommends": ["string"]
    }
    ```
    

---

## 9. 커맨드 (마지막 맵 커맨드 조회)

- **URL:** `/conversations/{conversation_id}/commands/map`
    
- **Method:** `GET`
    
- **Request**
    
- **Response**
    
    ```json
    {
      "commands": {
        "func": "move_center" | "render_orbit" | "render_satellite",
        "args": { "lat": number, "lng": number } | 
                { "orbit": { "geometry": "string", "datetimes": ["string"] } }
      }
    }
    ```
    

---

## 10. 페이지 커맨드

- **URL:** `/conversations/{conversation_id}/commands/page`
    
- **Method:** `GET`
    
- **Request**
    
- **Response (TODO)**
    
    ```json
    {
    
    }
    ```
    

---

## 11. 출처 조회

(상세 내용 없음)

---

## 12. 위성 영상 검색 결과 조회

(상세 내용 없음)

---

## 13. 분석 결과 조회

(상세 내용 없음)